<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Panel — Export settings.json</title>
  <style>
    body{font-family:Tahoma, Arial, sans-serif;background:#f6f7fb;margin:20px}
    .card{background:#fff;padding:14px;border-radius:8px;box-shadow:0 6px 20px rgba(0,0,0,.06);max-width:900px;margin:0 auto}
    textarea,input{width:100%;padding:8px;border:1px solid #e6e6e9;border-radius:6px;resize:vertical}
    label{font-weight:700;margin-top:8px;display:block}
    .row{display:flex;gap:8px;margin-top:12px}
    button{padding:8px 12px;border:none;border-radius:6px;background:#0ea5a3;color:#fff;cursor:pointer}
    button.secondary{background:#6b7280}
    .hint{font-size:13px;color:#555;margin-top:6px}
  </style>
</head>
<body>
  <div class="card">
    <h2>لوحة الإعدادات — تنزيل settings.json للرفع إلى GitHub</h2>

    <label>Ads Header (HTML / &lt;script&gt;)</label>
    <textarea id="ads-header" rows="4"></textarea>

    <label>Ads Footer</label>
    <textarea id="ads-footer" rows="3"></textarea>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
      <div>
        <label>Ads Left</label>
        <textarea id="ads-left" rows="4"></textarea>
      </div>
      <div>
        <label>Ads Right</label>
        <textarea id="ads-right" rows="4"></textarea>
      </div>
    </div>

    <label>Exchange Links (واحد في كل سطر)</label>
    <textarea id="exchange-links" rows="6" placeholder="https://example.com/"></textarea>

    <label>Blocked Sites (واحد في كل سطر)</label>
    <textarea id="blocked-sites" rows="3" placeholder="https://bad.example/"></textarea>

    <div class="row">
      <button id="download-json">تنزيل settings.json</button>
      <button id="load-local" class="secondary">تحميل من localStorage (إن وُجد)</button>
      <button id="save-local" class="secondary">حفظ محليًا (localStorage)</button>
    </div>

    <p class="hint">بعد الضغط على <strong>تنزيل settings.json</strong> ارفع الملف الناتج إلى مجلد المستودع <code>anwaree/-ODUI</code> في GitHub (Add file → Upload files أو Create new file ثم الصق المحتوى).</p>
  </div>

  <script>
    function getFormData() {
      const header = document.getElementById('ads-header').value;
      const footer = document.getElementById('ads-footer').value;
      const left = document.getElementById('ads-left').value;
      const right = document.getElementById('ads-right').value;
      const links = document.getElementById('exchange-links').value.split('\\n').map(x=>x.trim()).filter(Boolean);
      const blocked = document.getElementById('blocked-sites').value.split('\\n').map(x=>x.trim()).filter(Boolean);
      return {
        adsenseHeader: header,
        adsenseFooter: footer,
        adsenseLeft: left,
        adsenseRight: right,
        exchangeLinks: links,
        blockedSites: blocked
      };
    }

    document.getElementById('download-json').addEventListener('click', () => {
      const obj = getFormData();
      const blob = new Blob([JSON.stringify(obj, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'settings.json';
      a.click();
      URL.revokeObjectURL(url);
      alert('تم تنزيل settings.json — الآن ارفعه إلى GitHub repo (anwaree/-ODUI) في المسار الرئيسي.');
    });

    document.getElementById('save-local').addEventListener('click', () => {
      const obj = getFormData();
      localStorage.setItem('adminSettings', JSON.stringify(obj));
      localStorage.setItem('exchangeLinks', JSON.stringify(obj.exchangeLinks || []));
      alert('تم حفظ الإعدادات محليًا في localStorage.');
    });

    document.getElementById('load-local').addEventListener('click', () => {
      try {
        const s = JSON.parse(localStorage.getItem('adminSettings') || '{}');
        document.getElementById('ads-header').value = s.adsenseHeader || '';
        document.getElementById('ads-footer').value = s.adsenseFooter || '';
        document.getElementById('ads-left').value = s.adsenseLeft || '';
        document.getElementById('ads-right').value = s.adsenseRight || '';
        const links = JSON.parse(localStorage.getItem('exchangeLinks') || '[]');
        document.getElementById('exchange-links').value = links.join('\\n');
        document.getElementById('blocked-sites').value = (s.blockedSites || []).join('\\n');
        alert('تم تحميل الإعدادات من localStorage.');
      } catch (e) {
        alert('لا يوجد إعدادات في localStorage');
      }
    });

    // تحميل بدءي إن وُجد في localStorage
    document.getElementById('load-local').click();
  </script>
</body>
</html>
